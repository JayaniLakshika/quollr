---
title: "2. Visualise full hexagonal grid"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{visFullGrid}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
options(rmarkdown.html_vignette.check_title = FALSE)
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  warning = FALSE, 
  message = FALSE
)
```

```{r setup, echo = FALSE}
library(quollr)
library(snedata)
library(rsample)
library(umap)
library(ggplot2)
library(dplyr)
```

```{r echo = FALSE}
model <- fit_high_d_model(training_data = s_curve_noise_training, 
                 nldr_df_with_id = s_curve_noise_umap, num_bins_x = 4, 
                 shape_val = 1.833091)

df_bin_centroids <- model$df_bin_centroids
```

To generate the full hexagonal grid, you need to start from the bin centroid info that obtained from `extract_hexbin_centroids()`.

```{r}
## Data set with all possible centroids in the hexagonal grid

full_centroid_df <- generate_full_grid_centroids(df_bin_centroids)
full_centroid_df 

## Generate all coordinates of hexagons
hex_grid <- full_hex_grid(full_centroid_df)

ggplot(data = hex_grid, aes(x = x, y = y)) + geom_polygon(fill = "white", color = "black", aes(group = id)) +
  geom_point(data = hex_grid, aes(x = x, y = y), color = "black") +
  geom_point(data = df_bin_centroids, aes(x = x, y = y), color = "red")

ggplot(data = hex_grid, aes(x = x, y = y)) + geom_polygon(fill = "white", color = "black", aes(group = id)) +
  geom_point(data = full_centroid_df, aes(x = x, y = y), color = "black") +
  geom_point(data = df_bin_centroids, aes(x = x, y = y), color = "red")

hex_full_count_df <- generate_full_grid_info(df_bin_centroids)

ggplot(data = hex_full_count_df, aes(x = x, y = y)) +
  geom_polygon(color = "black", aes(group = polygon_id, fill = std_counts)) +
  geom_text(aes(x = c_x, y = c_y, label = hexID)) +
  scale_fill_viridis_c(direction = -1, na.value = "#ffffff")


```
